# Salary


## Задание
Реализуйте REST-сервис просмотра текущей зарплаты и даты следующего
повышения. Из-за того, что такие данные очень важны и критичны, каждый
сотрудник может видеть только свою сумму. Для обеспечения безопасности, вам
потребуется реализовать метод где по логину и паролю сотрудника будет выдан
секретный токен, который действует в течение определенного времени. Запрос
данных о зарплате должен выдаваться только при предъявлении валидного токена.

## Использованные технологии
- Python
- Poetry
- FastAPI
- Pydantic 
- Uvicorn
- Pytest
- Pytest-Asyncio


## Инструкция по запуску проекта локально

1. Клонировать репозиторий

    - с помощью SSH
    ```bash
    git clone git@hub.mos.ru:osipovyakovv/CFT_Test_Git.git
    ```
    - с помощью HTTPS
    ```bash
    git clone https://hub.mos.ru/osipovyakovv/CFT_Test_Git.git
    ```
2. Cоздать и активировать виртуальное окружение, установить зависимости


    - установить poetry, следуя [инструкции](https://python-poetry.org/docs/); 
    - настроить и создать виртуальное окружение в папке проекта, установить зависимости, активировать виртуальное окружение   
    ```bash
    cd salary_service
    poetry config virtualenvs.in-project true
    poetry install
    poetry shell

    ```

3. Запустить проекта

    ```bash
    uvicorn salary_service.main:app --reload
    ```

## Функциональность проекта 

Взаимодействовать с сервисом можно через 
* Swagger, в котором описаны возможности и примеры API запросов, перейдя по адресу http://127.0.0.1:8000/docs

### Аутентификация

Для получения токена аутентификации необходимо предоставить верные логин и пароль пользователя, которые существуют в базе данных. При верно введенных данных пользователь получает сообщение 'Токен успешно создан', а сам токен сохраняется в cookie.

Эндпоинт для получения токена
POST http://127.0.0.1:8000/token

Пример тела запроса:
```json
{
  "username": "user_1",
  "password": "password_1"
}
```

### Получение пользователем информации о заработной плате 

Получить информацию о заработной плате можно только при предоставлении токена, полученного при аутентификации. Срок действия токена ограничен (по умолчанию - 1 час). По его истечению пользователю необходимо вновь пройти процедуру аутентификации. 

Эндпоинт для получения информации о заработной плате
GET http://127.0.0.1:8000/salary

Пример ответа:

Пример тела ответа:
```json
[
  "user_1",
  {
    "salary": 100,
    "next_promotion": "2024-10-01"
  }
]

```
## Тестирование

Для того, чтобы запустить тестирование, необходимо из корневой директории перейти в директорию с тестами и выполнить следующую команду


```bash
pytest -v

```

---

**Автор**

Осипов Яков


